<!DOCTYPE html>
<html lang="en-UK">

<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0, user-scalable=yes" name="viewport"/>
    <meta content="Session 4: Projects" name="description"/>
    <link href="https://fonts.googleapis.com" rel="preconnect">
    <link crossorigin href="https://fonts.gstatic.com" rel="preconnect">
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+3:ital,wght@0,400;0,600;1,400&display=swap"
          rel="stylesheet">
    <link href="../scripts/style.css" media="screen" rel="stylesheet" type="text/css"/>
    <link href="../scripts/print_style.css" media="print" rel='stylesheet' type="text/css">
    <title>Session 4</title>
</head>

<body>

<div class="box">
    <h1 id="title">Session 4: Projects</h1>
</div>

<div class="box">
    <h2 id="overview">Contents</h2>
</div>

<div class="box">
    <h2 class='enum' id="toc_1">Projects</h2>

    <p> The following section contains short introductions to the projects for this course. All projects investigate adsorption onto a clay mineral
        for a variety of applications. Each project consists of multiple options, with each option requiring you to perform and compare two
        simulations.</p>
    <p> Clay minerals are a significant constituent of soils and sediments. Their high specific surface area and cation exchange capacity enables
        them to engage effectively with a variety of molecules and ions. Such capabilities are crucial in the context of environmental pollution
        control, where clay minerals play a vital role in the adsorption and immobilisation of contaminants, thereby influencing their migration
        and bioavailability in soils and aquatic systems. In pharmaceutical formulations, their ability to adsorb therapeutic agents and release
        them in a controlled manner can be used to control drug release kinetics. Another application of clay minerals is in the field of hazardous
        waste management, particularly concerning nuclear waste. They are employed to prevent the dispersal of radioactive materials into the
        environment and act as a natural barrier to contain and isolate contaminants. </p>

    <div class="tbox">
        <h3 class="pcollapsible" id="pH-dependent_adsorption_ciprofloxacin_onto_montmorillonite_and_kaolinite">pH-dependent adsorption of
            ciprofloxacin onto montmorillonite</h3>
        <div class="pcontent">
            <h4>Introduction</h4>
            <p>
                This project investigates the pH-dependent adsorption of ciprofloxacin (CIP) onto montmorillonite (MMT) and kaolinite (KAO) clays.
                CIP is a broad-spectrum antibiotic that is widely used in the treatment of bacterial infections. Depending on the pH of the
                environment, it can be present in three different protonation states (<a href="#cip_protonation">Figure 1</a>), which can affect its
                adsorption behaviour. The project aims to investigate the adsorption of CIP onto MMT and KAO clays at different pH values and to
                determine the effect of pH on the adsorption capacity and mechanisms.
            </p>

            <div class="flex-figure">
                <div class="figure" style="width: 100%">
                    <figure id="cip_protonation">
                        <img alt="CIP protonation states" src="img/cip_protonation.jpg" width="80%">
                        <figcaption>Figure 1: Chemical structures of ciprofloxacin species at different protonation states and corresponding pH
                            ranges. (From
                            <a href="https://doi.org/10.1016/j.watres.2012.10.010" target="_blank">Wu <em>et al.,</em> <strong>Water
                                Research</strong>, 2013.</a>)
                        </figcaption>
                    </figure>
                </div>
            </div>

            <h4>Suggested reading</h4>
            <ul style="margin-top:-4mm">
                <li>
                    <a href="https://doi.org/10.1016/j.watres.2012.10.010" target="_blank">Desorption of ciprofloxacin from clay mineral surfaces</a>
                </li>
            </ul>

            <h4 class="options" id="options_A"></h4>
            <button class="collapsible">Option 1</button>
            <div class="content">
                <table style="background: none; width: 50%; margin-bottom: 10px; margin-top: 10px">
                    <tr>
                        <th> </th>
                        <th>System 1</th>
                        <th>System 2</th>
                    </tr>
                    <tr>
                        <td>Clay</td>
                        <td> </td>
                        <td> </td>
                    </tr>
                    <tr>
                        <td>pH</td>
                        <td> </td>
                        <td> </td>
                    </tr>
                    <tr>
                        <td>Salt</td>
                        <td> </td>
                        <td> </td>
                    </tr>
                </table>
            </div>
            <button class="collapsible">Option 2</button>
            <div class="content">
                <table style="background: none; width: 50%; margin-bottom: 10px; margin-top: 10px">
                    <tr>
                        <th> </th>
                        <th>System 1</th>
                        <th>System 2</th>
                    </tr>
                    <tr>
                        <td>Clay</td>
                        <td> </td>
                        <td> </td>
                    </tr>
                    <tr>
                        <td>pH</td>
                        <td> </td>
                        <td> </td>
                    </tr>
                    <tr>
                        <td>Salt</td>
                        <td> </td>
                        <td> </td>
                    </tr>
                </table>
            </div>
            <button class="collapsible">Option 3</button>
            <div class="content">
                <table style="background: none; width: 50%; margin-bottom: 10px; margin-top: 10px">
                    <tr>
                        <th> </th>
                        <th>System 1</th>
                        <th>System 2</th>
                    </tr>
                    <tr>
                        <td>Clay</td>
                        <td> </td>
                        <td> </td>
                    </tr>
                    <tr>
                        <td>pH</td>
                        <td> </td>
                        <td> </td>
                    </tr>
                    <tr>
                        <td>Salt</td>
                        <td> </td>
                        <td> </td>
                    </tr>
                </table>
            </div>
            <button class="collapsible">Option 4</button>
            <div class="content">
                <table style="background: none; width: 50%; margin-bottom: 10px; margin-top: 10px">
                    <tr>
                        <th> </th>
                        <th>System 1</th>
                        <th>System 2</th>
                    </tr>
                    <tr>
                        <td>Clay</td>
                        <td> </td>
                        <td> </td>
                    </tr>
                    <tr>
                        <td>pH</td>
                        <td> </td>
                        <td> </td>
                    </tr>
                    <tr>
                        <td>Salt</td>
                        <td> </td>
                        <td> </td>
                    </tr>
                </table>
            </div>

            <h4>Tasks</h4>
            <p>
                All required files for this project are located inside the <code>[we are not providing the material]</code>
                folder. The following list provides a general description for the tasks of this project, which you should carry out for each of
                your systems.
            </p>
            <ol>
                <li>
                    Copy the <code>project_A</code> folder to your Desktop.
                </li>
                <li>
                    Use the unit cells to assemble a clay sheet.<br>
                    The dimensions should be around 3.5 &times; 5.0 nm in <em>x</em> and <em>y</em>.
                </li>
                <li>
                    Extend the simulation box <u>by</u> 50 &Aring; in the <em>z</em>-direction.
                </li>
                <li>
                    <p> Add the number of CIP molecules to the simulation box that corresponds to a concentration of 0.1&nbsp;mol&nbsp;L<sup>-1
                    </sup>.<br>
                        Use the prevalent protonation state at the pH-value of <strong>your option</strong>.</p>
                </li>
                <li>
                    Solvate the box with SPC water.
                </li>
                <li>
                    Add 0.1 mol&nbsp;L<sup>-1</sup> of the ion combination specified in <strong>your option</strong> and neutralise any excess
                    charge. If your cation has a charge different from +1, you need to add the <code>-pq</code> flag to specify the cation charge.
                    <strong>Make sure you name the ions with their periodic table name</strong>, i.e. use <code>Na</code> and not <code>NA</code>.
                </li>
                <li>
                    Perform an energy minimisation with a force tolerance of 500&nbsp;kJ&nbsp;mol<sup>-1</sup>&nbsp;nm<sup>-1</sup>.
                </li>
                <li>
                    Equilibrate the system for 100&nbsp;ps in the NPT ensemble at 300&nbsp;K and 1&nbsp;bar.
                </li>
                <li>
                    Run a 50&nbsp;ns production simulation in the NPT ensemble at 300&nbsp;K and 1&nbsp;bar.
                </li>
                <li>
                    Determine the point where the system reaches equilibrium. Use only the equilibrated portion for subsequent analysis.
                </li>
                <li>
                    Calculate the linear density of all components.
                </li>
                <li>
                    Determine the hydration shell of the ions.
                </li>
                <li>
                    Calculate the RDF of the interactions between the ions and the charged sites on the organics.
                </li>
                <li>
                    Use xmgrace to plot your results and save them in <code>.jpeg</code> format.
                </li>
                <li>
                    Inspect the final coordinates and trajectory in VMD and take snapshot(s) that illustrate the important
                    interactions within the system.
                </li>
                <li>
                    Compare and discuss your simulations, providing illustrations from your analysis and VMD as needed.
                </li>
            </ol>
        </div>
    </div>
</div>

<div class="box">
    <h2 class='enum' id="toc_2">Useful information</h2>

    <h3 class='enum' id="toc_2_1">Input files</h3>
    <p>
        Organic molecule structures and molecule definitions are located inside the <code>STRUCTURES</code> folders of
        each project.
        Force fields are inside the <code>FF</code> and clay unit cells inside the <code>CLAYS</code> folders.
        Run parameter <code>.mdp</code> files are inside <code>MDP</code>. Use <code>em.mdp</code> for energy
        minimisation, <code>nvt.mdp</code>
        for equilibration at constant temperature and volume, <code>npt.mdp</code> for equilibration at constant
        temperature and pressure
        and <code>prod.mdp</code> for the production run. Make sure to fill in any missing values for the keywords of
        the <code>.mdp</code> files
        that are marked with <code>COMPLETE HERE</code>.
    </p>
    <p>
        You will find template scripts for submitting your simulation on Eddie inside the project folder.<br>
        <em>Remember to run all of your simulations on the Eddie HPC, otherwise your simulation times will be longer than the project work
            duration!</em>
    </p>

    <h3 class='enum' id="toc_2_2">Calculating the number of organic molecules to reach a certain concentration</h3>
    <p>
        First, you will need to calculate the volume of the simulation box that is occupied by the solvent only. As you extended the box by 5 nm,
        this will be the height of your solvent box, By multiplying it by the simulation box dimensions in the x and y directions, you will obtain
        the volume of the solvent.
    </p>
    <p> You can then use Avogadro's number, the volume of the solvent (in dm<sup>3</sup>) and the target concentration (in mol dm<sup>-3</sup>) to
    calculate the number of molecules you need to add. Remember to round the value to the nearest whole number.</p>

    <h3 class='enum' id="toc_2_3">Making index files</h3>
    <p style="line-height: 1.5">
        Some of the analysis you are tasked with performing will require you to make an index file. You can do this using <code>gmx
        make_ndx</code>, and selecting the atoms you want. To determine the names of the atoms you want to add to the index file, you should
        visualise the molecule/unit cell in VMD. You can them select the atom(s) by pressing <code>1</code> on your keyboard, and a label will
        appear with the atom name.
    </p>
    <p> When using <code>gmx make_ndx</code> you can use the following selection language in the interactive menu:
    </p>
    <code style="display:block;white-space:pre-wrap;padding: 6px 10px;margin-top:-3mm;"> r &lt;residue_name&gt; & a &lt;atom_name&gt; </code>
    <p class="note" style="margin-top:0mm">You may be required to use wildcards (<code>*</code> or <code>?</code>) as part of the residue or atom
        name</p>
    <p>E.g. to make an index file containing the oxygen atoms in decanoic acid from session 3, you would select the atoms belonging to DECA
        residues, and filter for only oxygen atoms:</p>
    <code style="display:block;white-space:pre-wrap;padding: 6px 10px;margin-top:-3mm;">$ gmx make_ndx -f prod.gro -o analysis_groups.ndx </code>
    <code style="display:block;white-space:pre-wrap;padding: 6px 10px;margin-top:1mm;"> r DECA & a O*</code>
    <p style="margin-top:0mm">Then, press <code>q</code> to quit and save the index file</p>

    <p>For the clay oxygen atoms, we want to select only the surface atoms. You can do this using <code> r MMT & a OB* &! a OBS*</code> for MMT. For
        KAO, one surface can be selected using <code> r KAO & a OB* </code> and the other using <code> r KAO & a OH* </code>.</p>

    <h3 class='enum' id="toc_2_4">Calculating the co-ordination number of ions</h3>
    <p style="line-height: 1.5">
        Through the RDF analysis of the hydration shell of ions, you can also calculate the co-ordination number. To do this, use <code>gmx
        rdf</code> with the <code>-cn coordination_number.xvg</code> option, which will output cumulative RDF data. Plot this graph using
        <code>xmgrace</code> and read the y-value at the distance corresponding to the peak on the RDF graph (typically 0.2 to 0.4 nm). You will
        likely need to rescale the graph to read the y-value.
    </p>
    <p> When calculating the co-ordination of ions, it is <strong>very important</strong> that you select the cation as the reference point.</p>
</div>

</body>

<script>
    var coll = document.getElementsByClassName("collapsible");
    var i;

    for (i = 0; i < coll.length; i++) {
        coll[i].addEventListener("click", function () {
            this.classList.toggle("active");
            var content = this.nextElementSibling;
            if (content.style.display === "block") {
                content.style.display = "none";
            } else {
                content.style.display = "block";
            }
        });
    }

    var pcoll = document.getElementsByClassName("pcollapsible");
    var j;

    for (j = 0; j < pcoll.length; j++) {
        pcoll[j].addEventListener("click", function () {
            this.classList.toggle("active");
            let content = this.nextElementSibling;
            if (content.style.display === "block") {
                content.style.display = "none";
            } else {
                content.style.display = "block";
            }
        });
    }

</script>
<script src="../scripts/generate_header_s4.js"></script>
<script src="../scripts/generate_overview.js"></script>
<script src="../scripts/scroll_up.js"></script>
<script src="../scripts/feedback.js"></script>
<script src="../scripts/adjust_for_dyslexia.js"></script>
<script>window.onload = function () {
    generateOverview();
    generateHeader();
    scrollUp();
    adjustForDyslexia();
}</script>
</html>
